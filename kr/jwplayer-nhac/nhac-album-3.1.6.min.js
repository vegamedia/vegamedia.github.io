/*!
 * Nhac Web plugin for JW7 v3.1.6 support Album, remove Auto, Karaoke
 * Copyright 2017 Nhac.vn, Vega Corp
 * http://nhac.vn - 2017-10-02
 */
(function(U){U().registerPlugin("nhac","6.0",function(f,D,H){function U(){var a=E.getElementsByClassName("jw-icon-playback")[0];void 0!=a&&(void 0==N&&(N=document.createElement("div"),N.className="jw-icon jw-icon-inline jw-button-color jw-reset jw-icon-back-song",N.onclick=function(){var a=f.getPlaylist(),e=f.getPlaylistIndex();0==e?f.playlistItem(a.length-1):f.playlistItem(e-1)},a.parentNode.insertBefore(N,a)),void 0==O&&(O=document.createElement("div"),O.className="jw-icon jw-icon-inline jw-button-color jw-reset jw-icon-next-song",
O.onclick=function(){var a=f.getPlaylist();A.length>=a.length&&(A.length=0);if(P){var e=f.getPlaylistIndex();t=e==a.length-1?0:e+1}else{do t=Math.floor(Math.random()*a.length);while(-1<A.indexOf(t))}0>A.indexOf(t)&&A.push(t);f.playlistItem(t)},a.parentNode.insertBefore(O,a.nextSibling)));a=E.getElementsByClassName("jw-icon-hd")[0];void 0!=a&&(void 0==F&&(F=document.createElement("div"),F.className="jw-icon jw-icon-inline jw-button-color jw-reset jw-icon-repeat-all",F.onclick=function(){"jw-icon jw-icon-inline jw-button-color jw-reset jw-icon-repeat-all"==
F.className?(F.className="jw-icon jw-icon-inline jw-button-color jw-reset jw-icon-repeat-one",R=!0):(F.className="jw-icon jw-icon-inline jw-button-color jw-reset jw-icon-repeat-all",R=!1)},a.parentNode.insertBefore(F,a)),void 0==G&&(G=document.createElement("div"),G.className="jw-icon jw-icon-inline jw-button-color jw-reset jw-icon-sequence",G.onclick=function(){"jw-icon jw-icon-inline jw-button-color jw-reset jw-icon-sequence"==G.className?(G.className="jw-icon jw-icon-inline jw-button-color jw-reset jw-icon-shuffle",
P=!1):(G.className="jw-icon jw-icon-inline jw-button-color jw-reset jw-icon-sequence",P=!0)},a.parentNode.insertBefore(G,a)))}function ea(){if(void 0==x){var a=E.getElementsByClassName("jw-icon-hd")[0];void 0!=a&&(x=document.createElement("div"),x.className="jw-icon jw-icon-inline jw-button-color jw-reset jw-icon-lyric",x.onclick=function(){"jw-icon jw-icon-inline jw-button-color jw-reset jw-icon-lyric"==x.className?(x.className="jw-icon jw-icon-inline jw-button-color jw-reset jw-icon-lyric jw-toggle jw-off",
y.style.visibility="hidden"):(x.className="jw-icon jw-icon-inline jw-button-color jw-reset jw-icon-lyric",y.style.visibility="visible")},a.parentNode.insertBefore(x,a.nextSibling))}}function S(a){if(!M)if(null!=f.getConfig().captionsTrack&&0<f.getConfig().captionsTrack.cues.length){M=!0;a=f.getConfig().captionsTrack.cues;var d=!1;if(2<a.length){var e=a[1].text.toLowerCase();if(0<=e.indexOf("s\u00e1ng t\u00e1c")||0<=e.indexOf("ca s\u0129")||0<=e.indexOf("tr\u00ecnh b\u00e0y")||0<=e.indexOf("th\u1ec3 hi\u1ec7n")||
0<=e.indexOf("nh\u1ea1c s\u0129"))d=!0,a[0].startTime=0}if(D.resounded)for(var c=1;c<a.length+1;c++){e=a[c-1].text;var b=(e.match(/([\s]+)/g)||[]).length+1,n=a[c-1].endTime-a[c-1].startTime,g=n/b,h=0,m="|";c<a.length&&(h=a[c].startTime-a[c-1].endTime);if(3>=c&&D.lyric_debug||0<=e.toLowerCase().indexOf("nhac.vn"))10>c?10>n?console.log("@@@ ",c,n.toFixed(2),"/",b,"=",g.toFixed(4),"|",h.toFixed(2),m,e):console.log("@@@ ",c,n.toFixed(1),"/",b,"=",g.toFixed(4),"|",h.toFixed(2),m,e):console.log("@@@",c,
n.toFixed(2),"/",b,"=",g.toFixed(4),"|",h.toFixed(2),m,e);if(3<c&&0>e.toLowerCase().indexOf("nhac.vn")){var l=a[c-1].startTime-a[c-2].endTime,p=a[c-2].startTime-a[c-3].endTime,r=(a[c-2].text.match(/([\s]+)/g)||[]).length+1,v=a[c-2].endTime-a[c-2].startTime,q=v/r,u=n-q*b,w=0;if(1<=u||.9<h)m="$";D.lyric_debug&&(10>c?10>n?console.log("@@@ ",c,n.toFixed(2),"/",b,"=",g.toFixed(4),"|",h.toFixed(2),m,e,"/",u.toFixed(3)):console.log("@@@ ",c,n.toFixed(1),"/",b,"=",g.toFixed(4),"|",h.toFixed(2),m,e,"/",u.toFixed(3)):
console.log("@@@",c,n.toFixed(2),"/",b,"=",g.toFixed(4),"|",h.toFixed(2),m,e,"/",u.toFixed(3)));2.5<u||.8<u&&1.199<=h&&.9899<=g?w=5:2<u||1.2<u&&1<g||1.1<h&&.9<g?w=4:1.5<u||1.1<u&&.7<g||1<h&&1.2<u?w=3:1.8<h&&.7<g||3.1<h&&.44<g&&0==l&&0==p||3.2<h&&.6<g&&0==l||10<h&&.5<g&&.1>l&&.1>p||20<h&&.48<g&&.2>l&&.2>p?w=4.9<h&&.7<g&&0==l?4:3:2.09<h&&.59<g||2.2<h&&.6<g||1.68<h&&.72<g||1.69<h&&.6<g&&.2>l||1.1<h&&.4<g&&.1>l||.5<h&&.7<g&&.1>l?w=.7<u?3:2:1.1<u||1<u&&.58<g||2<=h&&.8<g?w=2:1<u||2<=h&&.49<g?w=1:.5<u&&
.79<g&&(D.lyric_debug&&(console.log("---",n.toFixed(3),"/",b,"=",g.toFixed(3),"|",h.toFixed(2)),console.log("---",v.toFixed(3),"/",r,"=",q.toFixed(3)),console.log("---",q.toFixed(3),"*",b,"=",(q*b).toFixed(3),"/",n.toFixed(3),"-",(q*b).toFixed(3),"=",u.toFixed(3))),w=1);5==w?(n=e.substr(e.length-1),a[c-1].text+=n+n+"...."):4==w?a[c-1].text+="....":3==w?a[c-1].text+="...":2==w?a[c-1].text+="..":1==w&&(a[c-1].text+=",");D.lyric_debug&&0<w&&console.log(" ->",a[c-1].text,g,"|",h,w)}}z=-1;k=[{startTime:0,
text:""}];c=a[0].startTime;!d&&""!=B&&2<c&&(d={},4<c?(d.text=V,d.startTime=0,d.endTime=a[0].startTime/2-.5,k.push(d),k.push({startTime:a[0].startTime/2,text:""}),d={},d.text="Ca s\u0129: "+W,d.startTime=a[0].startTime/2):(d.text=V+" - "+W,d.startTime=0),d.endTime=a[0].startTime-.5,k.push(d),k.push({startTime:a[0].startTime,text:""}));for(c=0;c<a.length;c++)k.push(a[c]),k.push({startTime:a[c].endTime,text:""}),D.resounded&&c<a.length-1&&(n=a[c+1].startTime-a[c].endTime,10<n&&(d={},30<n?(d.text="5 4 3 2 1",
d.startTime=a[c+1].startTime-2):20<n?(d.text="4 3 2 1",d.startTime=a[c+1].startTime-1.5):(d.text="3 2 1",d.startTime=a[c+1].startTime-1),d.endTime=a[c+1].startTime-.5,k.push(d),k.push({startTime:a[c+1].startTime,text:""})));X();ea();void 0!==x&&null!=f.getConfig().captionsTrack&&(Y="visible",y.style.visibility="visible",x.className="jw-icon jw-icon-inline jw-button-color jw-reset jw-icon-lyric")}else Z(a)}function fa(a){S("firstFrame2")}function ha(a){void 0==C&&(C=E.getElementsByClassName("jw-icon-hd")[0].getElementsByClassName("jw-option"));
1==C.length&&(a=C[0],"128K"==a.innerHTML?ca("320K (Login)",320):"128 kbps"==a.innerHTML&&ca("320 kbps (Login)",320));S("firstFrame")}function ca(a,d){var e=document.createElement("li");e.className="jw-text jw-option jw-item-1 jw-reset";e.innerHTML=a;e.onclick=function(){aa=!0;"function"===typeof onPlayerLoginVip&&onPlayerLoginVip(d)};var c=C[C.length-1];c.parentNode.insertBefore(e,c.nextSibling)}function Z(a){a=f.getConfig().playlistItem.tracks;void 0!=a&&0<a.length&&void 0!=a[0].file&&0==f.getCurrentCaptions()&&
f.setCurrentCaptions(1)}function ia(){if("visible"===Y){var a=y.clientWidth,d=Math.pow(a/420,.6),e=b.fontSize*d;p.style.maxWidth=a+"px";p.style.fontSize=Math.round(e)+"px";p.style.lineHeight=Math.round(1.4*e)+"px";p.style.position="relative";r.style.maxWidth=a+"px";r.style.fontSize=Math.round(e)+"px";r.style.lineHeight=Math.round(1.4*e)+"px";r.style.position="relative";r.style.display="inline-block";r.style.margin="0px";r.style.padding="0px";v.style.maxWidth=a+"px";v.style.fontSize=Math.round(e)+
"px";v.style.lineHeight=Math.round(1.4*e)+"px";v.style.position="relative";v.style.display="inline-block";v.style.margin="14px 0";m.style.color="#40ff91";m.style.position="absolute";m.style.top="0px";m.style.left="0px";m.style.overflow="hidden";m.style.whiteSpace="nowrap";m.style.textShadow="-1px 0 black, 0 1px black, 1px 0 black, 0 -1px black";m.style.lineHeight=Math.round(1.4*e)+"px";l.style.color="#40ff91";l.style.position="absolute";l.style.top="0px";l.style.left="0px";l.style.overflow="hidden";
l.style.whiteSpace="nowrap";l.style.textShadow="-1px 0 black, 0 1px black, 1px 0 black, 0 -1px black";l.style.lineHeight=Math.round(1.4*e)+"px";b.windowOpacity&&(I.style.padding=Math.round(5*d)+"px",I.style.borderRadius=Math.round(5*d)+"px")}}function da(a,d,e){if(!(J&&3<K)){var c=a.text,b=d.text;d=/<br\s*[\/]?>/gi;var n=!1;c=(c||"").replace(d," ");b=b.replace(d," ");if(""!==c&&""!==b){if(e){c!=m.innerHTML&&(m.style.width="0%",m.innerHTML=c,r.innerHTML=c);if(J||!n&&(""===l.innerHTML||L))n=!0,J&&(J=
!1),l.style.width="0%",l.innerHTML=b,v.innerHTML=b;r.appendChild(m)}else L&&(m.innerHTML=b,r.innerHTML=b,l.innerHTML=c,v.innerHTML=c),v.appendChild(l);if(c.length){setTimeout(ia,16);var g=1,h=0;var p=Math.round(1E3*(a.endTime-a.startTime)/50);L&&(g=(K-a.startTime)*p/(a.endTime-a.startTime));var q=setInterval(function(){if("paused"!=f.getState())if(h=g/p*100,100<h&&(h=100),K<a.startTime||Math.floor(K)>Math.ceil(a.endTime)||!M)clearInterval(q),z>=k.length-1&&(m.style.width="100%",l.style.width="100%",
r.appendChild(m),v.appendChild(l));else if(e?(!n&&g>p/3&&z<k.length-2&&(n=!0,l.style.width="0%",l.innerHTML=b,v.innerHTML=b),m.style.width=h+"%"):(!n&&g>p/3&&z<k.length-2&&(n=!0,m.style.width="0%",m.innerHTML=b,r.innerHTML=b),l.style.width=h+"%"),g++,g>=p+1||L)clearInterval(q),e?z<k.length-1&&(l.style.width="0%"):z<k.length-1&&(m.style.width="0%")},50)}}}}function X(){for(var a=-1,d=0;d<k.length;d++)if(k[d].startTime<=K&&(d===k.length-1||k[d+1].startTime>=K)){a=d;break}if(-1===a)da("");else if(a!==
z){z=a;d=!0;0==(a+1)/2%2&&(d=!1);var b=z<k.length-2?k[a+2]:k[a-2];L&&""===k[a].text&&""===b.text&&(z=a=a<k.length-1?a+1:a-1,d=0==(a+1)/2%2?!1:!0,b=z<k.length-2?k[a+2]:k[a-2]);da(k[a],b,d)}}function ba(a){a=String(a).replace("#","");3===a.length&&(a=a[0]+a[0]+a[1]+a[1]+a[2]+a[2]);return"#"+a.substr(-6)}function T(a,b){var d="rgb",c=[parseInt(a.substr(1,2),16),parseInt(a.substr(3,2),16),parseInt(a.substr(5,2),16)];void 0!==b&&100!==b&&(d+="a",c.push(b/100));return d+"("+c.join(",")+")"}"undefined"!==
typeof GoPerformance&&"function"===typeof GoPerformance&&GoPerformance(f,D,H);var O,N,x,F,G,E,C,b,k,y,I,p,r,m,v,l,z,Y="visible",L=!1,Q=-1,R=!1,P=!0,t=-1,A=[0],aa=!1,M=!1,J=!1,B,V,W,q;f.onReady(function(a){E=f.getContainer();H.style.position="absolute";H.style.top="40px";H.style.width="100%";H.style.overflow="hidden";H.style.pointerEvents="none";Z("onReady")});f.onBeforePlay(function(a){a=E.getElementsByClassName("jw-title-primary")[0];void 0!=a&&(B=a.innerHTML,0>B.indexOf("<font")&&0<B.indexOf(" - ")&&
(V=B.split(" - ")[0],W=B.split(" - ")[1],B=B.replace(" - "," - <font color='#c7c7c7'>"),B+="</font>",a.innerHTML=B))});f.on("meta",function(a){U();S("onMeta")});f.on("levels",function(a){var b=E.getElementsByClassName("jw-icon-hd")[0];void 0!=b&&(q=b.className,0<q.indexOf("jw-icon-hd-128")&&(q=q.substring(0,q.indexOf("jw-icon-hd-128")-1)),0<q.indexOf("jw-icon-hd-320")&&(q=q.substring(0,q.indexOf("jw-icon-hd-320")-1)),"320k"==a.levels[a.currentQuality].label.toLowerCase()?b.className=q+" jw-icon-hd-320":
"128k"==a.levels[a.currentQuality].label.toLowerCase()&&(b.className=q+" jw-icon-hd-128"))});f.on("visualQuality",function(a){void 0==C&&(C=E.getElementsByClassName("jw-icon-hd")[0].getElementsByClassName("jw-option"));"auto"!=a.mode&&"auto"!=a.reason||f.setCurrentQuality(a.level.index);0<C.length&&(a=C[0],"Auto"==a.innerHTML&&(a.className="jw-hidden"))});f.on("beforeComplete",function(a){if(R)Q=f.getPlaylistIndex();else if(!P){a=f.getPlaylist();A.length>=a.length&&(A.length=0);do t=Math.floor(Math.random()*
a.length);while(-1<A.indexOf(t));0>A.indexOf(t)&&A.push(t);Q=t}});f.on("playlistItem",function(a){M=!1;J=!0;m.innerHTML="";r.innerHTML="";l.innerHTML="";v.innerHTML="";(R||!P)&&0<=Q&&(a=Q,Q=-1,f.playlistItem(a));Y="hidden";y.style.visibility="hidden";void 0!==x&&(x.className="jw-icon jw-icon-inline jw-button-color jw-reset jw-icon-lyric jw-toggle jw-reset jw-hidden");Z("playlistItem")});if(void 0===D.showVIP||!1===D.showVIP)f.on("firstFrame",fa);else f.on("firstFrame",ha);f.on("levelsChanged",function(a){var b=
f.getCurrentQuality(),e=E.getElementsByClassName("jw-icon-hd")[0];"320k"==a.levels[b].label.toLowerCase()?e.className=q+" jw-icon-hd-320":"128k"==a.levels[b].label.toLowerCase()&&(e.className=q+" jw-icon-hd-128");aa&&(aa=!1,f.setCurrentQuality(0))});f.on("time",function(a){M&&(K=a.position,k&&X());M||(a=f.getConfig().playlistItem.tracks,void 0!=a&&0<a.length&&void 0!=a[0].file&&S("onTime"))});f.on("seek",function(a){L=!0;J&&1>a.position&&(J=!1);m.style.width="0%";l.style.width="0%"});f.on("seeked",
function(a){L=!1});this.resize=function(a,b){};(function(){b=f.getCaptions();void 0==b.color&&(b.color="#FFFFFF");void 0==b.fontFamily&&(b.fontFamily="Roboto, Arial, sans-serif");b.fontOpacity=100;void 0==b.fontStyle&&(b.fontStyle="normal");void 0==b.fontWeight&&(b.fontWeight="normal");void 0==b.textDecoration&&(b.textDecoration="none");void 0==b.edgeStyle&&(b.edgeStyle="uniform");void 0==b.backgroundColor&&(b.backgroundColor="#000");void 0==b.windowColor&&(b.windowColor="#FFFFFF");b.fontSize=17;
var a=b.fontOpacity,d=b.windowOpacity,e=b.edgeStyle,c=b.backgroundColor,k,n=T(ba(b.color),a),g=b.fontFamily,h=b.fontStyle,q=b.fontWeight,x=b.textDecoration,t;d&&(k=T(ba(b.windowColor),d));a=T("#000000",a);"dropshadow"===e?t="0 2px 1px "+a:"raised"===e?t="0 0 5px "+a+", 0 1px 5px "+a+", 0 2px 5px "+a:"depressed"===e?t="0 -2px 1px "+a:"uniform"===e&&(t="-2px 0 1px "+a+",2px 0 1px "+a+",0 -2px 1px "+a+",0 2px 1px "+a+",-1px 1px 1px "+a+",1px 1px 1px "+a+",1px -1px 1px "+a+",1px 1px 1px "+a);b.back&&
T(ba(c),b.backgroundOpacity);y=document.createElement("div");I=document.createElement("div");p=document.createElement("div");r=document.createElement("p");m=document.createElement("span");v=document.createElement("p");l=document.createElement("span");p.appendChild(r);p.appendChild(document.createElement("br"));p.appendChild(v);y.style.display="block";y.style.height="auto";y.style.position="absolute";y.style.textAlign="center";y.style.width="100%";y.style.zIndex="1";I.style.display="inline-block";
void 0!=k&&(I.style.backgroundColor=k);p.style.color=n;p.style.display="inline-block";p.style.fontFamily=g;p.style.fontStyle=h;p.style.fontWeight=q;p.style.textAlign="center";p.style.textDecoration=x;p.style.wordWrap="break-word";p.style.textShadow=t;I.appendChild(p);y.appendChild(I);H.appendChild(y)})();var K=0;k&&X()})})(jwplayer);