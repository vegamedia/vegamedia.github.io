/*!
 * Nhac Web plugin for JW7 v3.1.5.2 support Album, remove Auto, Karaoke
 * Copyright 2017 Nhac.vn, Vega Corp
 * http://nhac.vn - 2017-10-03
 */
(function(Q){Q().registerPlugin("nhac","6.0",function(f,A,D){function Q(){var a=z.getElementsByClassName("jw-icon-playback")[0];void 0!=a&&(void 0==J&&(J=document.createElement("div"),J.className="jw-icon jw-icon-inline jw-button-color jw-reset jw-icon-back-song",J.onclick=function(){var a=f.getPlaylist(),e=f.getPlaylistIndex();0==e?f.playlistItem(a.length-1):f.playlistItem(e-1)},a.parentNode.insertBefore(J,a)),void 0==K&&(K=document.createElement("div"),K.className="jw-icon jw-icon-inline jw-button-color jw-reset jw-icon-next-song",
K.onclick=function(){var a=f.getPlaylist();x.length>=a.length&&(x.length=0);if(L){var e=f.getPlaylistIndex();t=e==a.length-1?0:e+1}else{do t=Math.floor(Math.random()*a.length);while(-1<x.indexOf(t))}0>x.indexOf(t)&&x.push(t);f.playlistItem(t)},a.parentNode.insertBefore(K,a.nextSibling)));a=z.getElementsByClassName("jw-icon-hd")[0];void 0!=a&&(void 0==B&&(B=document.createElement("div"),B.className="jw-icon jw-icon-inline jw-button-color jw-reset jw-icon-repeat-all",B.onclick=function(){"jw-icon jw-icon-inline jw-button-color jw-reset jw-icon-repeat-all"==
B.className?(B.className="jw-icon jw-icon-inline jw-button-color jw-reset jw-icon-repeat-one",N=!0):(B.className="jw-icon jw-icon-inline jw-button-color jw-reset jw-icon-repeat-all",N=!1)},a.parentNode.insertBefore(B,a)),void 0==C&&(C=document.createElement("div"),C.className="jw-icon jw-icon-inline jw-button-color jw-reset jw-icon-sequence",C.onclick=function(){"jw-icon jw-icon-inline jw-button-color jw-reset jw-icon-sequence"==C.className?(C.className="jw-icon jw-icon-inline jw-button-color jw-reset jw-icon-shuffle",
L=!1):(C.className="jw-icon jw-icon-inline jw-button-color jw-reset jw-icon-sequence",L=!0)},a.parentNode.insertBefore(C,a)))}function aa(){if(void 0==q){var a=z.getElementsByClassName("jw-icon-hd")[0];void 0!=a&&(q=document.createElement("div"),q.className="jw-icon jw-icon-inline jw-button-color jw-reset jw-icon-lyric",q.onclick=function(){"jw-icon jw-icon-inline jw-button-color jw-reset jw-icon-lyric"==q.className?(q.className="jw-icon jw-icon-inline jw-button-color jw-reset jw-icon-lyric jw-toggle jw-off",
n.style.visibility="hidden"):(q.className="jw-icon jw-icon-inline jw-button-color jw-reset jw-icon-lyric",n.style.visibility="visible")},a.parentNode.insertBefore(q,a.nextSibling))}}function O(a){if(!I)if(null!=f.getConfig().captionsTrack&&0<f.getConfig().captionsTrack.cues.length){I=!0;a=f.getConfig().captionsTrack.cues;var d=!1;if(2<a.length){var e=a[1].text.toLowerCase();if(0<=e.indexOf("s\u00e1ng t\u00e1c")||0<=e.indexOf("ca s\u0129")||0<=e.indexOf("tr\u00ecnh b\u00e0y")||0<=e.indexOf("th\u1ec3 hi\u1ec7n")||
0<=e.indexOf("nh\u1ea1c s\u0129"))d=!0,a[0].startTime=0}if(A.resounded)for(var c=1;c<a.length;c++){e=a[c-1].text;var b=(e.match(/([\s]+)/g)||[]).length+1,v=a[c-1].endTime-a[c-1].startTime,l=v/b,k=a[c].startTime-a[c-1].endTime;A.lyric_debug&&console.log("i@@@@@@@@",c,Math.round(100*v)/100,"/",b,"=",Math.round(100*l)/100,"|",Math.round(100*k)/100,e);if(4<c){var h=a[c-1].startTime-a[c-2].endTime,m=a[c-2].startTime-a[c-3].endTime;if(.5<k&&.2>h&&.2>m)1.2<k&&(v=e.substr(e.length-1),a[c-1].text+=v+v+"."),
a[c-1].text+="...",A.lyric_debug&&console.log("i i-1 i-2",c,c-1,c-2,k,Math.round(100*h)/100,Math.round(100*m)/100,.5<k,.2>h,.2>m);else if(.9<l){h=(a[c-2].text.match(/([\s]+)/g)||[]).length+1;m=a[c-2].endTime-a[c-2].startTime;var r=m/h;k=v-r*b;A.lyric_debug&&(console.log("diiiiiiii",Math.round(100*v)/100,"/",b,"=",Math.round(100*l)/100),console.log("diiiiiiii",Math.round(100*m)/100,"/",h,"=",Math.round(100*r)/100),console.log("diiiiiiii",c,Math.round(100*r)/100,"*",b,"=",Math.round(r*b*100)/100,"|",
Math.round(100*v)/100,"--",Math.round(100*k)/100,e));2.5<k&&(v=e.substr(e.length-1),a[c-1].text+=v+v+".");1.5<k&&(a[c-1].text+="...")}}}w=-1;g=[{startTime:0,text:""}];c=a[0].startTime;!d&&""!=u&&2<c&&(d={},4<c?(d.text=R,d.startTime=0,d.endTime=a[0].startTime/2-.5,g.push(d),g.push({startTime:a[0].startTime/2,text:""}),d={},d.text="Ca s\u0129: "+S,d.startTime=a[0].startTime/2):(d.text=R+" - "+S,d.startTime=0),d.endTime=a[0].startTime-.5,g.push(d),g.push({startTime:a[0].startTime,text:""}));for(c=0;c<
a.length;c++)g.push(a[c]),g.push({startTime:a[c].endTime,text:""}),A.resounded&&c<a.length-1&&(v=a[c+1].startTime-a[c].endTime,10<v&&(d={},30<v?(d.text="5 4 3 2 1",d.startTime=a[c+1].startTime-2):20<v?(d.text="4 3 2 1",d.startTime=a[c+1].startTime-1.5):(d.text="3 2 1",d.startTime=a[c+1].startTime-1),d.endTime=a[c+1].startTime-.5,g.push(d),g.push({startTime:a[c+1].startTime,text:""})));T();aa();void 0!==q&&null!=f.getConfig().captionsTrack&&(U="visible",n.style.visibility="visible",q.className="jw-icon jw-icon-inline jw-button-color jw-reset jw-icon-lyric")}else V(a)}
function ba(a){O("firstFrame2")}function ca(a){void 0==y&&(y=z.getElementsByClassName("jw-icon-hd")[0].getElementsByClassName("jw-option"));1==y.length&&(a=y[0],"128K"==a.innerHTML?Y("320K (Login)",320):"128 kbps"==a.innerHTML&&Y("320 kbps (Login)",320));O("firstFrame")}function Y(a,d){var e=document.createElement("li");e.className="jw-text jw-option jw-item-1 jw-reset";e.innerHTML=a;e.onclick=function(){W=!0;"function"===typeof onPlayerLoginVip&&onPlayerLoginVip(d)};var c=y[y.length-1];c.parentNode.insertBefore(e,
c.nextSibling)}function V(a){a=f.getConfig().playlistItem.tracks;void 0!=a&&0<a.length&&void 0!=a[0].file&&0==f.getCurrentCaptions()&&f.setCurrentCaptions(1)}function da(){if("visible"===U){var a=n.clientWidth,d=Math.pow(a/420,.6),e=b.fontSize*d;h.style.maxWidth=a+"px";h.style.fontSize=Math.round(e)+"px";h.style.lineHeight=Math.round(1.4*e)+"px";h.style.position="relative";m.style.maxWidth=a+"px";m.style.fontSize=Math.round(e)+"px";m.style.lineHeight=Math.round(1.4*e)+"px";m.style.position="relative";
m.style.display="inline-block";m.style.margin="0px";m.style.padding="0px";r.style.maxWidth=a+"px";r.style.fontSize=Math.round(e)+"px";r.style.lineHeight=Math.round(1.4*e)+"px";r.style.position="relative";r.style.display="inline-block";r.style.margin="14px 0";l.style.color="#40ff91";l.style.position="absolute";l.style.top="0px";l.style.left="0px";l.style.overflow="hidden";l.style.whiteSpace="nowrap";l.style.textShadow="-1px 0 black, 0 1px black, 1px 0 black, 0 -1px black";l.style.lineHeight=Math.round(1.4*
e)+"px";k.style.color="#40ff91";k.style.position="absolute";k.style.top="0px";k.style.left="0px";k.style.overflow="hidden";k.style.whiteSpace="nowrap";k.style.textShadow="-1px 0 black, 0 1px black, 1px 0 black, 0 -1px black";k.style.lineHeight=Math.round(1.4*e)+"px";b.windowOpacity&&(E.style.padding=Math.round(5*d)+"px",E.style.borderRadius=Math.round(5*d)+"px")}}function Z(a,d,e){if(!(F&&3<G)){var c=a.text,b=d.text;d=/<br\s*[\/]?>/gi;var h=!1;c=(c||"").replace(d," ");b=b.replace(d," ");if(""!==c&&
""!==b){if(e){c!=l.innerHTML&&(l.style.width="0%",l.innerHTML=c,m.innerHTML=c);if(F||!h&&(""===k.innerHTML||H))h=!0,F&&(F=!1),k.style.width="0%",k.innerHTML=b,r.innerHTML=b;m.appendChild(l)}else H&&(l.innerHTML=b,m.innerHTML=b,k.innerHTML=c,r.innerHTML=c),r.appendChild(k);if(c.length){setTimeout(da,16);var n=1,p=0;var q=Math.round(1E3*(a.endTime-a.startTime)/50);H&&(n=(G-a.startTime)*q/(a.endTime-a.startTime));var t=setInterval(function(){if("paused"!=f.getState())if(p=n/q*100,100<p&&(p=100),G<a.startTime||
Math.floor(G)>Math.ceil(a.endTime)||!I)clearInterval(t),w>=g.length-1&&(l.style.width="100%",k.style.width="100%",m.appendChild(l),r.appendChild(k));else if(e?(!h&&n>q/3&&w<g.length-2&&(h=!0,k.style.width="0%",k.innerHTML=b,r.innerHTML=b),l.style.width=p+"%"):(!h&&n>q/3&&w<g.length-2&&(h=!0,l.style.width="0%",l.innerHTML=b,m.innerHTML=b),k.style.width=p+"%"),n++,n>=q+1||H)clearInterval(t),e?w<g.length-1&&(k.style.width="0%"):w<g.length-1&&(l.style.width="0%")},50)}}}}function T(){for(var a=-1,d=0;d<
g.length;d++)if(g[d].startTime<=G&&(d===g.length-1||g[d+1].startTime>=G)){a=d;break}if(-1===a)Z("");else if(a!==w){w=a;d=!0;0==(a+1)/2%2&&(d=!1);var b=w<g.length-2?g[a+2]:g[a-2];H&&""===g[a].text&&""===b.text&&(w=a=a<g.length-1?a+1:a-1,d=0==(a+1)/2%2?!1:!0,b=w<g.length-2?g[a+2]:g[a-2]);Z(g[a],b,d)}}function X(a){a=String(a).replace("#","");3===a.length&&(a=a[0]+a[0]+a[1]+a[1]+a[2]+a[2]);return"#"+a.substr(-6)}function P(a,d){var b="rgb",c=[parseInt(a.substr(1,2),16),parseInt(a.substr(3,2),16),parseInt(a.substr(5,
2),16)];void 0!==d&&100!==d&&(b+="a",c.push(d/100));return b+"("+c.join(",")+")"}"undefined"!==typeof GoPerformance&&"function"===typeof GoPerformance&&GoPerformance(f,A,D);var K,J,q,B,C,z,y,b,g,n,E,h,m,l,r,k,w,U="visible",H=!1,M=-1,N=!1,L=!0,t=-1,x=[0],W=!1,I=!1,F=!1,u,R,S,p;f.onReady(function(a){z=f.getContainer();D.style.position="absolute";D.style.top="40px";D.style.width="100%";D.style.overflow="hidden";D.style.pointerEvents="none";V("onReady")});f.onBeforePlay(function(a){a=z.getElementsByClassName("jw-title-primary")[0];
void 0!=a&&(u=a.innerHTML,0>u.indexOf("<font")&&0<u.indexOf(" - ")&&(R=u.split(" - ")[0],S=u.split(" - ")[1],u=u.replace(" - "," - <font color='#c7c7c7'>"),u+="</font>",a.innerHTML=u))});f.on("meta",function(a){Q();O("onMeta")});f.on("levels",function(a){var d=z.getElementsByClassName("jw-icon-hd")[0];void 0!=d&&(p=d.className,0<p.indexOf("jw-icon-hd-128")&&(p=p.substring(0,p.indexOf("jw-icon-hd-128")-1)),0<p.indexOf("jw-icon-hd-320")&&(p=p.substring(0,p.indexOf("jw-icon-hd-320")-1)),"320k"==a.levels[a.currentQuality].label.toLowerCase()?
d.className=p+" jw-icon-hd-320":"128k"==a.levels[a.currentQuality].label.toLowerCase()&&(d.className=p+" jw-icon-hd-128"))});f.on("visualQuality",function(a){void 0==y&&(y=z.getElementsByClassName("jw-icon-hd")[0].getElementsByClassName("jw-option"));"auto"!=a.mode&&"auto"!=a.reason||f.setCurrentQuality(a.level.index);0<y.length&&(a=y[0],"Auto"==a.innerHTML&&(a.className="jw-hidden"))});f.on("beforeComplete",function(a){if(N)M=f.getPlaylistIndex();else if(!L){a=f.getPlaylist();x.length>=a.length&&
(x.length=0);do t=Math.floor(Math.random()*a.length);while(-1<x.indexOf(t));0>x.indexOf(t)&&x.push(t);M=t}});f.on("playlistItem",function(a){I=!1;F=!0;l.innerHTML="";m.innerHTML="";k.innerHTML="";r.innerHTML="";(N||!L)&&0<=M&&(a=M,M=-1,f.playlistItem(a));U="hidden";n.style.visibility="hidden";void 0!==q&&(q.className="jw-icon jw-icon-inline jw-button-color jw-reset jw-icon-lyric jw-toggle jw-reset jw-hidden");V("playlistItem")});if(void 0===A.showVIP||!1===A.showVIP)f.on("firstFrame",ba);else f.on("firstFrame",
ca);f.on("levelsChanged",function(a){var d=f.getCurrentQuality(),b=z.getElementsByClassName("jw-icon-hd")[0];"320k"==a.levels[d].label.toLowerCase()?b.className=p+" jw-icon-hd-320":"128k"==a.levels[d].label.toLowerCase()&&(b.className=p+" jw-icon-hd-128");W&&(W=!1,f.setCurrentQuality(0))});f.on("time",function(a){I&&(G=a.position,g&&T());I||(a=f.getConfig().playlistItem.tracks,void 0!=a&&0<a.length&&void 0!=a[0].file&&O("onTime"))});f.on("seek",function(a){H=!0;F&&1>a.position&&(F=!1);l.style.width=
"0%";k.style.width="0%"});f.on("seeked",function(a){H=!1});this.resize=function(a,b){};(function(){b=f.getCaptions();void 0==b.color&&(b.color="#FFFFFF");void 0==b.fontFamily&&(b.fontFamily="Roboto, Arial, sans-serif");b.fontOpacity=100;void 0==b.fontStyle&&(b.fontStyle="normal");void 0==b.fontWeight&&(b.fontWeight="normal");void 0==b.textDecoration&&(b.textDecoration="none");void 0==b.edgeStyle&&(b.edgeStyle="uniform");void 0==b.backgroundColor&&(b.backgroundColor="#000");void 0==b.windowColor&&
(b.windowColor="#FFFFFF");b.fontSize=17;var a=b.fontOpacity,d=b.windowOpacity,e=b.edgeStyle,c=b.backgroundColor,g,p=P(X(b.color),a),q=b.fontFamily,t=b.fontStyle,w=b.fontWeight,x=b.textDecoration,u;d&&(g=P(X(b.windowColor),d));a=P("#000000",a);"dropshadow"===e?u="0 2px 1px "+a:"raised"===e?u="0 0 5px "+a+", 0 1px 5px "+a+", 0 2px 5px "+a:"depressed"===e?u="0 -2px 1px "+a:"uniform"===e&&(u="-2px 0 1px "+a+",2px 0 1px "+a+",0 -2px 1px "+a+",0 2px 1px "+a+",-1px 1px 1px "+a+",1px 1px 1px "+a+",1px -1px 1px "+
a+",1px 1px 1px "+a);b.back&&P(X(c),b.backgroundOpacity);n=document.createElement("div");E=document.createElement("div");h=document.createElement("div");m=document.createElement("p");l=document.createElement("span");r=document.createElement("p");k=document.createElement("span");h.appendChild(m);h.appendChild(document.createElement("br"));h.appendChild(r);n.style.display="block";n.style.height="auto";n.style.position="absolute";n.style.textAlign="center";n.style.width="100%";n.style.zIndex="1";E.style.display=
"inline-block";void 0!=g&&(E.style.backgroundColor=g);h.style.color=p;h.style.display="inline-block";h.style.fontFamily=q;h.style.fontStyle=t;h.style.fontWeight=w;h.style.textAlign="center";h.style.textDecoration=x;h.style.wordWrap="break-word";h.style.textShadow=u;E.appendChild(h);n.appendChild(E);D.appendChild(n)})();var G=0;g&&T()})})(jwplayer);